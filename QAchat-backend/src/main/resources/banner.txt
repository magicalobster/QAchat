by magicalobsterï¼šhttps://github.com/magicalobster
refactor from: https://github.com/liyupi
